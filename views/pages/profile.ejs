<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="icon" href="img/favicon.ico.png" type="image/png">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">

    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/profile.css">
    <link href='https://fonts.googleapis.com/css?family=Brawler' rel='stylesheet'>
    <script src="js/scripts.js"></script>
    <script src="js/navbar.js"></script>

</head>

<body>
    <header>
        <nav class="navbar navbar-expand-md navbar-dark navbar-color-primary">
            <div class="container-fluid">
                <a class="navbar-brand" href="home">
                    <img src="img/Logo-SemFundo.svg" width="120" height="100" class="d-inline-block align-center"
                        alt="">
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"
                    aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav ms-auto mb-2 mb-md-0">
                        <li class="nav-item">
                            <a class="nav-link" aria-current="page" href="contact">Contato</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="profile">Ver Perfil</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="chat">Chat</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="userName" onclick="deslogar()">Logoff</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <div>
        <div class="profile-banner">
        </div>
        <div class="container">
            <div class="profile-info">
                <div onclick="history.back()" class="div_voltar">
                    <img src="img/seta-esquerda.png" class="seta" alt="">
                </div>
                <div class="div_fotoeedicao">
                    <!-- Colocar uma classe na div abaixo e inserir algumas estilizações que estão na imagem-->
                    <div>
                        <img class="div_foto"
                            src="data:image/jpeg;base64,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"
                            alt="">
                    </div>
                    <button id="btnDesfazer" style="display: none; height: auto;" class="btn-lg btn_perfil" onclick="desfazerAtualizarPerfil()">Desfazer última alteração</button>

                </div>
                <div class="info-col">
                    <div class="info-row">
                        <div class="div_descricoes">
                            <h2 class="texto" id="nome_adv">José da Silva Romeiro</h2>
                            <h4 class="descricao" id="especializacao">Especialização</h4>
                            <p id="cidade" class="estado">São Paulo, SP</p>
                        </div>
                        <button class="btn-lg btn-editar" onclick="aparecerModal()">Editar Perfil</button>
                    </div>
                    <div class="card" id="descricao">
                        Adicione uma descrição
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal" id="div_modal">
        <div class="div_editar">
            <h2 class="modal-title">Monte seu Perfil</h2>
            <div class="div_modaldescricao">
                <div class="div_perfil"></div>
                <div class="modal-col">
                    <div class="input-area">
                        <label for="nameInput" class="label">Nome Completo</label>
                        <input type="text" class="input-field" id="nameInput">
                    </div>
                    <div class="input-area">
                        <label for="specializationInput" class="label">Especialização</label>
                        <input type="text" class="input-field" id="specializationInput">
                    </div>
                    <div class="button-div">
                        <button class="btn-lg"> Adicionar foto </button>

                    </div>
                </div>
            </div>
            <div class="div_sobre">
                <div class="input-area">
                    <label for="sobreInput" class="label">Sobre</label>
                    <textarea type="text" class="area-field" id="aboutInput"></textarea>
                </div>
            </div>
            <button class="btn-lg btn_concluir" id="btn_concluir" onclick="clickAtualizarPerfil()">Concluir</button>
        </div>
    </div>

</body>

</html>
<script>
    const pilhaAdvogados = []

    async function getAdvogado(idAdvogado) {
        const retorno = await fetch(`http://localhost:8080/usuario/advogado/buscarPorId/${idAdvogado}`, {
            method: "GET",
            headers: {
                "Content-type": "application/json; charset=UTF-8"
            }
        })
        const dadosRequisicao = await retorno.json()

        console.log(dadosRequisicao)
        loadAdvogado(dadosRequisicao)

        
        document.getElementById("cidade").innerHTML = dadosRequisicao.cidade

    }

    function loadAdvogado(advogado) {
        document.getElementById("nome_adv").innerHTML = advogado.nome
        document.getElementById("especializacao").innerHTML = advogado.especializacao
        document.getElementById("descricao").innerHTML = advogado.sobre

        document.getElementById("nameInput").value = advogado.nome
        document.getElementById("specializationInput").value = advogado.especializacao
        document.getElementById("aboutInput").value = advogado.sobre
    }

    async function clickAtualizarPerfil() {
        pilhaAdvogados.push({
            nome: document.getElementById("nome_adv").innerHTML,
            especializacao: document.getElementById("especializacao").innerHTML,
            sobre: document.getElementById("descricao").innerHTML
        })
        
        const perfil = {
            nome: document.getElementById("nameInput").value,
            especializacao: document.getElementById("specializationInput").value,
            sobre: document.getElementById("aboutInput").value
        }

        await atualizarPerfil(perfil)

        desaparecerModal()

        document.getElementById("btnDesfazer").style.display = pilhaAdvogados.length > 0 ? "block" : "none"

    }

    async function desfazerAtualizarPerfil() {
        perfil = pilhaAdvogados.pop()

        await atualizarPerfil(perfil)

        document.getElementById("btnDesfazer").style.display = pilhaAdvogados.length > 0 ? "block" : "none"

    }

    async function atualizarPerfil(novoPerfil) {
        const retorno = await fetch(`http://localhost:8080/usuario/advogado/editar/${sessionStorage.getItem("userId")}`, {
            method: "PATCH",
            body: JSON.stringify(novoPerfil),
            headers: {
                "Content-type": "application/json; charset=UTF-8",
                "Access-Control-Allow-Origin": "http://localhost:3000"
            }
        })

        const dadosRequisicao = await retorno.json()

        loadAdvogado(dadosRequisicao)

        sessionStorage.setItem("userName", dadosRequisicao.nome)
    }

    window.onload = function () {
        const idAdvogado = sessionStorage.getItem("userId");
        getAdvogado(idAdvogado)
    }

</script>